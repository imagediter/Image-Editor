<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Image Compressor Tool</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root {
  --blue: #0d6efd;
  --light: #f5f9ff;
  --white: #ffffff;
}

body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: var(--light);
}

.container {
  max-width: 1100px;
  margin: auto;
  padding: 20px;
}

h1 {
  text-align: center;
  color: var(--blue);
}

.card {
  background: var(--white);
  padding: 20px;
  border-radius: 12px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.1);
}

.controls {
  display: flex;
  flex-wrap: wrap;
  gap: 15px;
  align-items: center;
  justify-content: space-between;
}

input[type="file"] {
  padding: 10px;
}

.range-box {
  flex: 1;
}

input[type="range"] {
  width: 100%;
}

button {
  background: var(--blue);
  color: white;
  border: none;
  padding: 10px 18px;
  border-radius: 8px;
  cursor: pointer;
  font-size: 14px;
}

button.secondary {
  background: #6c757d;
}

button:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

.preview-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
  gap: 15px;
  margin-top: 20px;
}

.preview-item {
  background: var(--light);
  border-radius: 10px;
  padding: 10px;
  text-align: center;
}

.preview-item img {
  width: 100%;
  border-radius: 8px;
}

.size-info {
  font-size: 13px;
  margin: 8px 0;
}

.download-btn {
  display: block;
  margin-top: 8px;
  text-decoration: none;
  background: var(--blue);
  color: white;
  padding: 8px;
  border-radius: 6px;
  font-size: 13px;
}

@media (max-width: 600px) {
  .controls {
    flex-direction: column;
  }
}
</style>
</head>

<body>

<div class="container">
  <h1>Image Compressor</h1>

  <div class="card">
    <div class="controls">
      <input type="file" id="upload" accept="image/*" multiple>

      <div class="range-box">
        <label>Compression Quality: <strong id="qualityValue">70%</strong></label>
        <input type="range" id="quality" min="10" max="100" value="70">
      </div>

      <button onclick="resetAll()" class="secondary">Reset</button>
    </div>

    <div class="preview-grid" id="previewGrid"></div>
  </div>
</div>

<script>
const upload = document.getElementById("upload");
const previewGrid = document.getElementById("previewGrid");
const qualitySlider = document.getElementById("quality");
const qualityValue = document.getElementById("qualityValue");

qualitySlider.addEventListener("input", () => {
  qualityValue.textContent = qualitySlider.value + "%";
  if (upload.files.length) processImages(upload.files);
});

upload.addEventListener("change", () => {
  previewGrid.innerHTML = "";
  processImages(upload.files);
});

function processImages(files) {
  previewGrid.innerHTML = "";

  [...files].forEach(file => {
    const reader = new FileReader();
    reader.onload = e => compressImage(e.target.result, file);
    reader.readAsDataURL(file);
  });
}

function compressImage(src, file) {
  const img = new Image();
  img.src = src;

  img.onload = () => {
    const canvas = document.createElement("canvas");
    const ctx = canvas.getContext("2d");

    canvas.width = img.width;
    canvas.height = img.height;
    ctx.drawImage(img, 0, 0);

    const quality = qualitySlider.value / 100;
    const compressedData = canvas.toDataURL("image/jpeg", quality);

    const originalSize = (file.size / 1024).toFixed(1);
    const compressedSize = (compressedData.length / 1024).toFixed(1);

    const div = document.createElement("div");
    div.className = "preview-item";
    div.innerHTML = `
      <img src="${compressedData}">
      <div class="size-info">
        Original: ${originalSize} KB<br>
        Compressed: ${compressedSize} KB
      </div>
      <a href="${compressedData}" download="compressed-${file.name}" class="download-btn">
        Download
      </a>
    `;

    previewGrid.appendChild(div);
  };
}

function resetAll() {
  upload.value = "";
  previewGrid.innerHTML = "";
}
</script>

</body>
</html>

