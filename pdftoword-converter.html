<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>PDF ↔ Word Converter | Advanced Tool</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- ICONS -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<!-- LIBRARIES -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.worker.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/docx/8.2.2/index.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>

<style>
:root{
--blue:#0066ff;
--dark:#0044cc;
--bg:#f4f7fb;
--card:#fff;
--border:#e2e8f0;
}
*{box-sizing:border-box;font-family:Segoe UI,Roboto}
body{margin:0;background:var(--bg);padding:20px}
.container{max-width:1200px;margin:auto}
header{
background:linear-gradient(135deg,var(--blue),var(--dark));
color:#fff;padding:35px;border-radius:16px;text-align:center
}
.grid{
display:grid;
grid-template-columns:repeat(auto-fit,minmax(340px,1fr));
gap:25px;margin-top:30px
}
.card{
background:var(--card);padding:25px;border-radius:14px;
box-shadow:0 10px 25px rgba(0,0,0,.08)
}
.card h2{color:var(--blue)}
.drop{
border:2px dashed var(--border);
padding:35px;border-radius:12px;
text-align:center;cursor:pointer
}
.drop i{font-size:38px;color:var(--blue)}
button{
width:100%;padding:14px;
border:none;border-radius:10px;
background:var(--blue);color:#fff;
font-size:16px;font-weight:600;
margin-top:12px;cursor:pointer
}
button:disabled{background:#ccc}
.progress{height:8px;background:#eee;border-radius:10px;overflow:hidden;margin-top:10px}
.progress span{display:block;height:100%;width:0;background:#28a745}
small{color:#555}
#preview{position:absolute;left:-9999px;width:800px}
</style>
</head>

<body>
<div class="container">

<header>
<h1><i class="fas fa-sync"></i> PDF ↔ Word Converter</h1>
<p>OCR • Password PDF • Bulk Conversion • 100% Browser-Side</p>
</header>

<div class="grid">

<!-- PDF TO WORD -->
<div class="card">
<h2><i class="fas fa-file-pdf"></i> PDF → Word</h2>

<div class="drop" id="pdfDrop">
<i class="fas fa-cloud-upload-alt"></i>
<p>Drop PDF or Click</p>
<input type="file" id="pdfInput" hidden multiple accept=".pdf">
</div>

<input id="pdfPassword" placeholder="PDF Password (optional)" style="width:100%;padding:10px;margin-top:10px">

<label><input type="checkbox" id="useOCR"> Enable OCR (Scanned PDFs)</label>

<button id="pdfBtn" disabled>Convert PDF</button>
<div class="progress"><span id="pdfProg"></span></div>
</div>

<!-- WORD TO PDF -->
<div class="card">
<h2><i class="fas fa-file-word"></i> Word → PDF</h2>

<div class="drop" id="wordDrop">
<i class="fas fa-cloud-upload-alt"></i>
<p>Drop DOCX or Click</p>
<input type="file" id="wordInput" hidden multiple accept=".docx">
</div>

<button id="wordBtn" disabled>Convert Word</button>
<div class="progress"><span id="wordProg"></span></div>
</div>

</div>
<div id="preview"></div>
</div>

<script>
pdfjsLib.GlobalWorkerOptions.workerSrc =
'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.worker.min.js';

let pdfFiles=[],wordFiles=[];

/* DROP ZONES */
const bindDrop=(box,input,cb)=>{
box.onclick=()=>input.click();
box.ondragover=e=>{e.preventDefault();box.style.borderColor='#0066ff'}
box.ondragleave=()=>box.style.borderColor='';
box.ondrop=e=>{
e.preventDefault();box.style.borderColor='';
cb([...e.dataTransfer.files])
};
input.onchange=()=>cb([...input.files]);
};

bindDrop(pdfDrop,pdfInput,f=>{pdfFiles=f;pdfBtn.disabled=false});
bindDrop(wordDrop,wordInput,f=>{wordFiles=f;wordBtn.disabled=false});

/* PDF → WORD */
pdfBtn.onclick=async()=>{
const zip=new JSZip();
const useOCR=document.getElementById("useOCR").checked;
const password=document.getElementById("pdfPassword").value;
pdfProg.style.width="0%";

for(let i=0;i<pdfFiles.length;i++){
const data=await pdfFiles[i].arrayBuffer();
const pdf=await pdfjsLib.getDocument({data,password}).promise;
let text="";

for(let p=1;p<=pdf.numPages;p++){
const page=await pdf.getPage(p);
if(useOCR){
const viewport=page.getViewport({scale:2});
const canvas=document.createElement("canvas");
canvas.width=viewport.width;
canvas.height=viewport.height;
await page.render({canvasContext:canvas.getContext("2d"),viewport}).promise;
const ocr=await Tesseract.recognize(canvas,'eng');
text+=ocr.data.text+"\n\n";
}else{
const c=await page.getTextContent();
text+=c.items.map(i=>i.str).join(" ")+"\n\n";
}
pdfProg.style.width=(((i+p/pdf.numPages)/pdfFiles.length)*100)+"%";
}

const doc=new docx.Document({
sections:[{children:text.split("\n").map(t=>new docx.Paragraph(t))}]
});
const blob=await docx.Packer.toBlob(doc);

pdfFiles.length==1?
saveAs(blob,pdfFiles[i].name.replace('.pdf','.docx')):
zip.file(pdfFiles[i].name.replace('.pdf','.docx'),blob);
}

if(pdfFiles.length>1)
saveAs(await zip.generateAsync({type:"blob"}),"pdf_to_word.zip");
};

/* WORD → PDF */
wordBtn.onclick=async()=>{
const zip=new JSZip();
wordProg.style.width="0%";

for(let i=0;i<wordFiles.length;i++){
const html=await mammoth.convertToHtml({arrayBuffer:await wordFiles[i].arrayBuffer()});
preview.innerHTML=html.value;

const pdf=await html2pdf().from(preview).set({
margin:.5,image:{type:'jpeg',quality:.98},
html2canvas:{scale:2},jsPDF:{unit:'in',format:'letter'}
}).output('blob');

wordFiles.length==1?
saveAs(pdf,wordFiles[i].name.replace('.docx','.pdf')):
zip.file(wordFiles[i].name.replace('.docx','.pdf'),pdf);

wordProg.style.width=((i+1)/wordFiles.length*100)+"%";
}

if(wordFiles.length>1)
saveAs(await zip.generateAsync({type:"blob"}),"word_to_pdf.zip");
};
</script>
</body>
</html>
